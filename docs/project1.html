<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Wenqiang Feng" />


<title>Project #1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">STAT 538: Statistics for Research II</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Chapter 1</li>
    <li>
      <a href="note1.html">Note #1</a>
    </li>
    <li>
      <a href="hw2.html">Note #2</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Chapter 2</li>
    <li>
      <a href="projtct1.html">Note #3</a>
    </li>
    <li>
      <a href="project2.html">Note #4</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Homework
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 1</li>
    <li>
      <a href="hw1.html">HW #1</a>
    </li>
    <li>
      <a href="hw2.html">HW #2</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 2</li>
    <li>
      <a href="hw3.html">HW #3</a>
    </li>
    <li>
      <a href="hw4.html">HW #4</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 3</li>
    <li>
      <a href="hw5.html">HW #5</a>
    </li>
    <li>
      <a href="hw6.html">HW #6</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 4</li>
    <li>
      <a href="hw7.html">HW #7</a>
    </li>
    <li>
      <a href="hw8.html">HW #8</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 5</li>
    <li>
      <a href="hw9.html">HW #9</a>
    </li>
    <li>
      <a href="hw10.html">HW #10</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Project 1</li>
    <li>
      <a href="project1.html">Project #1</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Project 2</li>
    <li>
      <a href="project2.html">Project #2</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
    About
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/runawayhorse001/STAT538">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://web.utk.edu/~wfeng1">
    <span class="fa fa-question fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Project #1</h1>
<h4 class="author"><em>Wenqiang Feng</em></h4>
<h4 class="date"><em>2/2/2017</em></h4>

</div>


<pre class="r"><code>library(ggplot2)
library(plyr)
library(gplots)
library(asbio)
library(corrplot)
library(car)
library(MASS)
library(caret)
library(lmtest)
library(gvlma)</code></pre>
<div id="load-data" class="section level4">
<h4>Load data</h4>
<pre class="r"><code>C5 &lt;- read.table(&quot;./data/APPENC05.txt&quot;)
data = C5[,2:9]
y=C5[,2]
X=C5[,3:9]</code></pre>
</div>
<div id="problem-1" class="section level3">
<h3>Problem 1</h3>
<ul>
<li>Stem-and-Leaf Plot</li>
</ul>
<pre class="r"><code>stem(X$V3)</code></pre>
<pre><code>## 
##   The decimal point is 1 digit(s) to the right of the |
## 
##   0 | 00000111111111111111222222222222333333333334444444444
##   0 | 555555666666778888889
##   1 | 01233444
##   1 | 55667788
##   2 | 033
##   2 | 67
##   3 | 2
##   3 | 
##   4 | 
##   4 | 6</code></pre>
<pre class="r"><code>stem(X$V4)</code></pre>
<pre><code>## 
##   The decimal point is 2 digit(s) to the right of the |
## 
##   0 | 11222222222223333333333333333333333333333334444444444444444444
##   0 | 55555555555555555566666667778889
##   1 | 12
##   1 | 
##   2 | 
##   2 | 
##   3 | 
##   3 | 
##   4 | 
##   4 | 5</code></pre>
<pre class="r"><code>stem(X$V5)</code></pre>
<pre><code>## 
##   The decimal point is 1 digit(s) to the right of the |
## 
##   4 | 134
##   4 | 779
##   5 | 0024
##   5 | 6778888999
##   6 | 000001111122233333334444444
##   6 | 555555566666677788888888888899999
##   7 | 000012222334
##   7 | 67789</code></pre>
<pre class="r"><code>stem(X$V6)</code></pre>
<pre><code>## 
##   The decimal point is at the |
## 
##    0 | 000000000000000000000000000000000000000000046602366666899
##    2 | 66156667999
##    4 | 13478012355558899
##    6 | 26159
##    8 | 338
##   10 | 1333</code></pre>
<pre class="r"><code>stem(X$V7)</code></pre>
<pre><code>## 
##   The decimal point is 1 digit(s) to the left of the |
## 
##    0 | 00000000000000000000000000000000000000000000000000000000000000000000
##    2 | 
##    4 | 
##    6 | 
##    8 | 
##   10 | 000000000000000000000</code></pre>
<pre class="r"><code>stem(X$V8)</code></pre>
<pre><code>## 
##   The decimal point is at the |
## 
##    0 | 00000000000000000000000000000000000000000000044444557777779112234466
##    2 | 222337779
##    4 | 388138
##    6 | 288
##    8 | 28
##   10 | 33277
##   12 | 2
##   14 | 3
##   16 | 
##   18 | 2</code></pre>
<pre class="r"><code>stem(X$V9)</code></pre>
<pre><code>## 
##   The decimal point is 1 digit(s) to the left of the |
## 
##   60 | 000000000000000000000000000000000
##   62 | 
##   64 | 
##   66 | 
##   68 | 
##   70 | 0000000000000000000000000000000000000000000
##   72 | 
##   74 | 
##   76 | 
##   78 | 
##   80 | 000000000000000000000</code></pre>
<ul>
<li>Correlation matrix</li>
</ul>
<pre class="r"><code>M = cor(X)
M</code></pre>
<pre><code>##              V3           V4         V5          V6           V7
## V3  1.000000000  0.005107148 0.03909442 -0.13320943  0.581741687
## V4  0.005107148  1.000000000 0.16432371  0.32184875 -0.002410475
## V5  0.039094423  0.164323714 1.00000000  0.36634121  0.117658038
## V6 -0.133209431  0.321848748 0.36634121  1.00000000 -0.119553192
## V7  0.581741687 -0.002410475 0.11765804 -0.11955319  1.000000000
## V8  0.692896688  0.001578905 0.09955535 -0.08300865  0.680284092
## V9  0.481438397 -0.024206925 0.22585181  0.02682555  0.428573479
##              V8          V9
## V3  0.692896688  0.48143840
## V4  0.001578905 -0.02420693
## V5  0.099555351  0.22585181
## V6 -0.083008649  0.02682555
## V7  0.680284092  0.42857348
## V8  1.000000000  0.46156590
## V9  0.461565896  1.00000000</code></pre>
<pre class="r"><code>corrplot(M, type=&quot;upper&quot;)</code></pre>
<p><img src="project1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<ul>
<li>From the above Correlation matrix plot, we can conclude that the V3 is highly correlative with V7, V8 and V9, V7 is highly correlative with V8. Hence i will revome V3 and V8.</li>
</ul>
</div>
<div id="problem-2" class="section level3">
<h3>Problem 2</h3>
<ul>
<li>linear fitting</li>
</ul>
<pre class="r"><code>data2 = data[,c(1,3:6,8)]</code></pre>
<pre class="r"><code>fit &lt;- lm(V2~., data=data2)</code></pre>
<pre class="r"><code>summary(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = V2 ~ ., data = data2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -54.396 -11.101  -2.597   4.607 194.427 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -48.31074   43.22326  -1.118  0.26664    
## V4            0.03030    0.08036   0.377  0.70700    
## V5           -0.67654    0.51670  -1.309  0.19371    
## V6            0.84190    1.30234   0.646  0.51961    
## V7           42.84222    9.40561   4.555 1.62e-05 ***
## V9           14.90066    5.29694   2.813  0.00601 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 33.93 on 91 degrees of freedom
## Multiple R-squared:  0.3437, Adjusted R-squared:  0.3077 
## F-statistic: 9.532 on 5 and 91 DF,  p-value: 2.452e-07</code></pre>
<pre class="r"><code>par(mfrow=c(2,2)) # init 4 charts in 1 panel
plot(fit)</code></pre>
<p><img src="project1_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<ul>
<li>Check the data for potential influential observations</li>
</ul>
<pre class="r"><code>cd&lt;-which(cooks.distance(fit)&gt;3.0)
covr&lt;-which(covratio(fit)&gt;2.0)
rst&lt;-which(abs(rstudent(fit))&gt;4)
index&lt;-sort(unique(c(cd,covr,rst)))
index</code></pre>
<pre><code>## [1] 32 96 97</code></pre>
<pre class="r"><code>plot(fit, which=4)
abline(h=3.0, col=&quot;blue&quot;, lty=3)</code></pre>
<p><img src="project1_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<ul>
<li>From the above analysis with the given criteria, we can conclude that obervation 32, 96, 97 are probability be the potential influential observations.</li>
</ul>
</div>
<div id="problem-3" class="section level3">
<h3>Problem 3</h3>
<ul>
<li>Check for Multicollinearity problems, and identify any variables that are involved in creating multicollinearity.</li>
</ul>
<pre class="r"><code>vif_func&lt;-function(in_frame,thresh=10,trace=T,...){

  require(fmsb)
  
  if(class(in_frame) != &#39;data.frame&#39;) in_frame&lt;-data.frame(in_frame)
  
  #get initial vif value for all comparisons of variables
  vif_init&lt;-NULL
  var_names &lt;- names(in_frame)
  for(val in var_names){
      regressors &lt;- var_names[-which(var_names == val)]
      form &lt;- paste(regressors, collapse = &#39;+&#39;)
      form_in &lt;- formula(paste(val, &#39;~&#39;, form))
      vif_init&lt;-rbind(vif_init, c(val, VIF(lm(form_in, data = in_frame, ...))))
      }
  vif_max&lt;-max(as.numeric(vif_init[,2]), na.rm = TRUE)

  if(vif_max &lt; thresh){
    if(trace==T){ #print output of each iteration
        prmatrix(vif_init,collab=c(&#39;var&#39;,&#39;vif&#39;),rowlab=rep(&#39;&#39;,nrow(vif_init)),quote=F)
        cat(&#39;\n&#39;)
        cat(paste(&#39;All variables have VIF &lt; &#39;, thresh,&#39;, max VIF &#39;,round(vif_max,2), sep=&#39;&#39;),&#39;\n\n&#39;)
        }
    return(var_names)
    }
  else{

    in_dat&lt;-in_frame

    #backwards selection of explanatory variables, stops when all VIF values are below &#39;thresh&#39;
    while(vif_max &gt;= thresh){
      
      vif_vals&lt;-NULL
      var_names &lt;- names(in_dat)
        
      for(val in var_names){
        regressors &lt;- var_names[-which(var_names == val)]
        form &lt;- paste(regressors, collapse = &#39;+&#39;)
        form_in &lt;- formula(paste(val, &#39;~&#39;, form))
        vif_add&lt;-VIF(lm(form_in, data = in_dat, ...))
        vif_vals&lt;-rbind(vif_vals,c(val,vif_add))
        }
      max_row&lt;-which(vif_vals[,2] == max(as.numeric(vif_vals[,2]), na.rm = TRUE))[1]

      vif_max&lt;-as.numeric(vif_vals[max_row,2])

      if(vif_max&lt;thresh) break
      
      if(trace==T){ #print output of each iteration
        prmatrix(vif_vals,collab=c(&#39;var&#39;,&#39;vif&#39;),rowlab=rep(&#39;&#39;,nrow(vif_vals)),quote=F)
        cat(&#39;\n&#39;)
        cat(&#39;removed: &#39;,vif_vals[max_row,1],vif_max,&#39;\n\n&#39;)
        flush.console()
        }

      in_dat&lt;-in_dat[,!names(in_dat) %in% vif_vals[max_row,1]]

      }

    return(names(in_dat))
    
    }
  
  }</code></pre>
<pre class="r"><code>vif_func(in_frame=X,thresh=4,trace=T)</code></pre>
<pre><code>## Loading required package: fmsb</code></pre>
<pre><code>##  var vif             
##  V3  2.16260575041746
##  V4  1.12894126727313
##  V5  1.24048938465825
##  V6  1.31117777017478
##  V7  2.00933072949621
##  V8  2.51634553896314
##  V9  1.45870140337424
## 
## All variables have VIF &lt; 4, max VIF 2.52</code></pre>
<pre><code>## [1] &quot;V3&quot; &quot;V4&quot; &quot;V5&quot; &quot;V6&quot; &quot;V7&quot; &quot;V8&quot; &quot;V9&quot;</code></pre>
<pre class="r"><code>NewData = data2[-c(index),]
fit &lt;- lm(V2~., data=NewData)</code></pre>
<pre class="r"><code># Evaluate Collinearity
vif(fit) # variance inflation factors </code></pre>
<pre><code>##       V4       V5       V6       V7       V9 
## 1.599769 1.249200 1.634566 1.235077 1.245702</code></pre>
<pre class="r"><code>vif(fit) &gt; 4 # problem?</code></pre>
<pre><code>##    V4    V5    V6    V7    V9 
## FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
<div id="problem-4" class="section level3">
<h3>Problem 4</h3>
<ul>
<li>Check for problems with heteroscedasticity.</li>
<li>Breusch-Pagan test</li>
</ul>
<pre class="r"><code>lmtest::bptest(fit)</code></pre>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  fit
## BP = 14.2, df = 5, p-value = 0.01439</code></pre>
<ul>
<li>Breusch-Pagan test</li>
</ul>
<pre class="r"><code>car::ncvTest(fit)  </code></pre>
<pre><code>## Non-constant Variance Score Test 
## Variance formula: ~ fitted.values 
## Chisquare = 102.4705    Df = 1     p = 4.378427e-24</code></pre>
<p>With a p-value of are less than 0.05, we reject the null hypothesis (that variance of residuals is constant) and therefore infer that ther residuals are not homoscedastic.</p>
<ul>
<li>Alterative method: The gvlma( ) function in the gvlma package, performs a global validation of linear model assumptions as well separate evaluations of skewness, kurtosis, and heteroscedasticity.</li>
</ul>
<pre class="r"><code>gvmodel &lt;- gvlma(fit) 
summary(gvmodel)</code></pre>
<pre><code>## 
## Call:
## lm(formula = V2 ~ ., data = NewData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -32.472  -8.442  -1.590   4.551 113.250 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -9.6969    23.7474  -0.408  0.68402    
## V4            0.2343     0.1253   1.869  0.06489 .  
## V5           -0.7839     0.2842  -2.759  0.00706 ** 
## V6           -0.2332     0.8024  -0.291  0.77201    
## V7           25.7531     5.2755   4.882 4.66e-06 ***
## V9            9.3938     2.9409   3.194  0.00195 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.48 on 88 degrees of freedom
## Multiple R-squared:  0.4261, Adjusted R-squared:  0.3935 
## F-statistic: 13.07 on 5 and 88 DF,  p-value: 1.625e-09
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = fit) 
## 
##                      Value   p-value                   Decision
## Global Stat        1168.18 0.000e+00 Assumptions NOT satisfied!
## Skewness            132.62 0.000e+00 Assumptions NOT satisfied!
## Kurtosis            961.49 0.000e+00 Assumptions NOT satisfied!
## Link Function        14.91 1.125e-04 Assumptions NOT satisfied!
## Heteroscedasticity   59.15 1.465e-14 Assumptions NOT satisfied!</code></pre>
</div>
<div id="problem-5" class="section level1">
<h1>Problem 5</h1>
<ul>
<li>I applied the stepwise AIC to do the variable selection.</li>
</ul>
<pre class="r"><code>SWfit = stepAIC(fit, direction=&quot;both&quot;)</code></pre>
<pre><code>## Start:  AIC=554.16
## V2 ~ V4 + V5 + V6 + V7 + V9
## 
##        Df Sum of Sq   RSS    AIC
## - V6    1      28.9 30090 552.25
## &lt;none&gt;              30061 554.16
## - V4    1    1193.8 31255 555.82
## - V5    1    2599.6 32661 559.96
## - V9    1    3485.4 33546 562.47
## - V7    1    8140.5 38201 574.69
## 
## Step:  AIC=552.25
## V2 ~ V4 + V5 + V7 + V9
## 
##        Df Sum of Sq   RSS    AIC
## &lt;none&gt;              30090 552.25
## + V6    1      28.9 30061 554.16
## - V4    1    1381.1 31471 554.47
## - V5    1    2903.1 32993 558.91
## - V9    1    3526.9 33617 560.67
## - V7    1    8742.8 38833 574.23</code></pre>
<ul>
<li>The best model is as follows:</li>
</ul>
<pre class="r"><code>summary(SWfit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = V2 ~ V4 + V5 + V7 + V9, data = NewData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -32.639  -8.025  -1.663   4.672 113.076 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -8.5916    23.3200  -0.368  0.71343    
## V4            0.2154     0.1066   2.021  0.04627 *  
## V5           -0.8038     0.2743  -2.930  0.00430 ** 
## V7           26.0790     5.1284   5.085 2.02e-06 ***
## V9            9.4373     2.9219   3.230  0.00174 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.39 on 89 degrees of freedom
## Multiple R-squared:  0.4256, Adjusted R-squared:  0.3998 
## F-statistic: 16.49 on 4 and 89 DF,  p-value: 3.846e-10</code></pre>
<pre class="r"><code>par(mfrow=c(2,2)) # init 4 charts in 1 panel
plot(SWfit)</code></pre>
<p><img src="project1_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<pre class="r"><code>gvmodel &lt;- gvlma(SWfit) 
summary(gvmodel)</code></pre>
<pre><code>## 
## Call:
## lm(formula = V2 ~ V4 + V5 + V7 + V9, data = NewData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -32.639  -8.025  -1.663   4.672 113.076 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -8.5916    23.3200  -0.368  0.71343    
## V4            0.2154     0.1066   2.021  0.04627 *  
## V5           -0.8038     0.2743  -2.930  0.00430 ** 
## V7           26.0790     5.1284   5.085 2.02e-06 ***
## V9            9.4373     2.9219   3.230  0.00174 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.39 on 89 degrees of freedom
## Multiple R-squared:  0.4256, Adjusted R-squared:  0.3998 
## F-statistic: 16.49 on 4 and 89 DF,  p-value: 3.846e-10
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = SWfit) 
## 
##                      Value   p-value                   Decision
## Global Stat        1158.81 0.000e+00 Assumptions NOT satisfied!
## Skewness            131.50 0.000e+00 Assumptions NOT satisfied!
## Kurtosis            952.63 0.000e+00 Assumptions NOT satisfied!
## Link Function        15.63 7.715e-05 Assumptions NOT satisfied!
## Heteroscedasticity   59.05 1.532e-14 Assumptions NOT satisfied!</code></pre>
</div>

<center>Copyright &copy; 2017 Ming Chen  & Wenqiang Feng. All rights reserved.</center>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
