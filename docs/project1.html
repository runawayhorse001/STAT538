<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Ming Chen &amp; Wenqiang Feng" />


<title>Project #1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">STAT 538: Statistics for Research II</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Chapter 1</li>
    <li>
      <a href="note1.html">Note #1</a>
    </li>
    <li>
      <a href="hw2.html">Note #2</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Chapter 2</li>
    <li>
      <a href="projtct1.html">Note #3</a>
    </li>
    <li>
      <a href="project2.html">Note #4</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Homework
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 1</li>
    <li>
      <a href="hw1.html">HW #1</a>
    </li>
    <li>
      <a href="hw2.html">HW #2</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 2</li>
    <li>
      <a href="hw3.html">HW #3</a>
    </li>
    <li>
      <a href="hw4.html">HW #4</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 3</li>
    <li>
      <a href="hw5.html">HW #5</a>
    </li>
    <li>
      <a href="hw6.html">HW #6</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 4</li>
    <li>
      <a href="hw7.html">HW #7</a>
    </li>
    <li>
      <a href="hw8.html">HW #8</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Project 1</li>
    <li>
      <a href="project1.html">Project #1</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Project 2</li>
    <li>
      <a href="project2.html">Project #2</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
    About
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/runawayhorse001/STAT538">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://web.utk.edu/~wfeng1">
    <span class="fa fa-question fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Project #1</h1>
<h4 class="author"><em>Ming Chen &amp; Wenqiang Feng</em></h4>
<h4 class="date"><em>2/2/2017</em></h4>

</div>


<pre class="r"><code>library(ggplot2)
library(plyr)
library(gplots)
library(asbio)
library(corrplot)
library(car)</code></pre>
<div id="load-data" class="section level4">
<h4>Load data</h4>
<pre class="r"><code>C5 &lt;- read.table(&quot;./data/APPENC05.txt&quot;)
data = C5[,2:9]
y=C5[,2]
X=C5[,3:9]
#colnames(data1612) = c(&quot;time_lapse&quot;, &quot;agent&quot;)</code></pre>
</div>
<div id="stem-and-leaf-plot" class="section level3">
<h3>Stem-and-Leaf Plot</h3>
<pre class="r"><code>stem(X$V3)</code></pre>
<pre><code>## 
##   The decimal point is 1 digit(s) to the right of the |
## 
##   0 | 00000111111111111111222222222222333333333334444444444
##   0 | 555555666666778888889
##   1 | 01233444
##   1 | 55667788
##   2 | 033
##   2 | 67
##   3 | 2
##   3 | 
##   4 | 
##   4 | 6</code></pre>
<pre class="r"><code>stem(X$V4)</code></pre>
<pre><code>## 
##   The decimal point is 2 digit(s) to the right of the |
## 
##   0 | 11222222222223333333333333333333333333333334444444444444444444
##   0 | 55555555555555555566666667778889
##   1 | 12
##   1 | 
##   2 | 
##   2 | 
##   3 | 
##   3 | 
##   4 | 
##   4 | 5</code></pre>
<pre class="r"><code>stem(X$V5)</code></pre>
<pre><code>## 
##   The decimal point is 1 digit(s) to the right of the |
## 
##   4 | 134
##   4 | 779
##   5 | 0024
##   5 | 6778888999
##   6 | 000001111122233333334444444
##   6 | 555555566666677788888888888899999
##   7 | 000012222334
##   7 | 67789</code></pre>
<pre class="r"><code>stem(X$V6)</code></pre>
<pre><code>## 
##   The decimal point is at the |
## 
##    0 | 000000000000000000000000000000000000000000046602366666899
##    2 | 66156667999
##    4 | 13478012355558899
##    6 | 26159
##    8 | 338
##   10 | 1333</code></pre>
<pre class="r"><code>stem(X$V7)</code></pre>
<pre><code>## 
##   The decimal point is 1 digit(s) to the left of the |
## 
##    0 | 00000000000000000000000000000000000000000000000000000000000000000000
##    2 | 
##    4 | 
##    6 | 
##    8 | 
##   10 | 000000000000000000000</code></pre>
<pre class="r"><code>stem(X$V8)</code></pre>
<pre><code>## 
##   The decimal point is at the |
## 
##    0 | 00000000000000000000000000000000000000000000044444557777779112234466
##    2 | 222337779
##    4 | 388138
##    6 | 288
##    8 | 28
##   10 | 33277
##   12 | 2
##   14 | 3
##   16 | 
##   18 | 2</code></pre>
<pre class="r"><code>stem(X$V9)</code></pre>
<pre><code>## 
##   The decimal point is 1 digit(s) to the left of the |
## 
##   60 | 000000000000000000000000000000000
##   62 | 
##   64 | 
##   66 | 
##   68 | 
##   70 | 0000000000000000000000000000000000000000000
##   72 | 
##   74 | 
##   76 | 
##   78 | 
##   80 | 000000000000000000000</code></pre>
</div>
<div id="correlation-matrix" class="section level3">
<h3>Correlation matrix</h3>
<pre class="r"><code>M = cor(X)
M</code></pre>
<pre><code>##              V3           V4         V5          V6           V7
## V3  1.000000000  0.005107148 0.03909442 -0.13320943  0.581741687
## V4  0.005107148  1.000000000 0.16432371  0.32184875 -0.002410475
## V5  0.039094423  0.164323714 1.00000000  0.36634121  0.117658038
## V6 -0.133209431  0.321848748 0.36634121  1.00000000 -0.119553192
## V7  0.581741687 -0.002410475 0.11765804 -0.11955319  1.000000000
## V8  0.692896688  0.001578905 0.09955535 -0.08300865  0.680284092
## V9  0.481438397 -0.024206925 0.22585181  0.02682555  0.428573479
##              V8          V9
## V3  0.692896688  0.48143840
## V4  0.001578905 -0.02420693
## V5  0.099555351  0.22585181
## V6 -0.083008649  0.02682555
## V7  0.680284092  0.42857348
## V8  1.000000000  0.46156590
## V9  0.461565896  1.00000000</code></pre>
<pre class="r"><code>corrplot(M, type=&quot;upper&quot;)</code></pre>
<p><img src="project1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>fit &lt;- lm(V2~., data=data)</code></pre>
<pre class="r"><code>summary(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = V2 ~ ., data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -61.330  -8.130  -0.014   6.324 167.436 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -15.24264   40.53932  -0.376 0.707814    
## V3            2.03225    0.59359   3.424 0.000936 ***
## V4            0.01132    0.07395   0.153 0.878708    
## V5           -0.53721    0.47588  -1.129 0.261977    
## V6            1.29831    1.20168   1.080 0.282878    
## V7           19.60957   10.89184   1.800 0.075187 .  
## V8            1.09877    1.33377   0.824 0.412253    
## V9            7.05922    5.19452   1.359 0.177589    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 31.17 on 89 degrees of freedom
## Multiple R-squared:  0.4585, Adjusted R-squared:  0.4159 
## F-statistic: 10.77 on 7 and 89 DF,  p-value: 9.266e-10</code></pre>
<pre class="r"><code>par(mfrow=c(2,2)) # init 4 charts in 1 panel
plot(fit)</code></pre>
<p><img src="project1_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>cd&lt;-which(cooks.distance(fit)&gt;3.0)
covr&lt;-which(covratio(fit)&gt;2.0)
rst&lt;-which(abs(rstudent(fit))&gt;4)
index&lt;-sort(unique(c(cd,covr,rst)))
index</code></pre>
<pre><code>## [1] 32 96 97</code></pre>
<pre class="r"><code>NewData = data[-c(index),]</code></pre>
<pre class="r"><code>plot(fit, which=4)
abline(h=3.0, col=&quot;blue&quot;, lty=3)</code></pre>
<p><img src="project1_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>lmtest::bptest(fit)</code></pre>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  fit
## BP = 25.085, df = 7, p-value = 0.000733</code></pre>
<pre class="r"><code># Evaluate Collinearity
vif(fit) # variance inflation factors </code></pre>
<pre><code>##       V3       V4       V5       V6       V7       V8       V9 
## 2.162606 1.128941 1.240489 1.311178 2.009331 2.516346 1.458701</code></pre>
<pre class="r"><code>vif(fit) &gt; 2 # problem?</code></pre>
<pre><code>##    V3    V4    V5    V6    V7    V8    V9 
##  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE</code></pre>
<pre class="r"><code># Choose a VIF cutoff under which a variable is retained (Zuur et al. 2010 
# MEE recommends 2)
cutoff=2
# Create function to sequentially drop the variable with the largest VIF until 
# all variables have VIF &gt; cutoff
flag=TRUE
viftable=data.frame()
while(flag==TRUE) {
  vfit=vif(fit)
  viftable=rbind.fill(viftable,as.data.frame(t(vfit)))
  if(max(vfit)&gt;cutoff) { fit=
    update(fit,as.formula(paste(&quot;.&quot;,&quot;~&quot;,&quot;.&quot;,&quot;-&quot;,names(which.max(vfit))))) }
  else { flag=FALSE } }</code></pre>
<pre class="r"><code>summary(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = V2 ~ V3 + V4 + V5 + V6 + V7 + V9, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -54.794  -8.778   0.223   5.391 164.042 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -18.91802   40.22107  -0.470   0.6392    
## V3            2.25470    0.52767   4.273 4.78e-05 ***
## V4            0.01090    0.07382   0.148   0.8830    
## V5           -0.53047    0.47496  -1.117   0.2670    
## V6            1.31986    1.19925   1.101   0.2740    
## V7           23.61941    9.72629   2.428   0.0172 *  
## V9            7.53201    5.15350   1.462   0.1474    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 31.11 on 90 degrees of freedom
## Multiple R-squared:  0.4544, Adjusted R-squared:  0.418 
## F-statistic: 12.49 on 6 and 90 DF,  p-value: 3.393e-10</code></pre>
<pre class="r"><code>SWfit = stepAIC(fit, direction=&quot;both&quot;)</code></pre>
<pre><code>## Start:  AIC=673.63
## V2 ~ V3 + V4 + V5 + V6 + V7 + V9
## 
##        Df Sum of Sq    RSS    AIC
## - V4    1      21.1  87138 671.65
## - V6    1    1172.5  88289 672.93
## - V5    1    1207.4  88324 672.96
## &lt;none&gt;               87117 673.63
## - V9    1    2067.6  89184 673.90
## - V7    1    5708.2  92825 677.78
## - V3    1   17673.4 104790 689.55
## 
## Step:  AIC=671.65
## V2 ~ V3 + V5 + V6 + V7 + V9
## 
##        Df Sum of Sq    RSS    AIC
## - V5    1    1192.3  88330 670.97
## - V6    1    1382.8  88521 671.18
## &lt;none&gt;               87138 671.65
## - V9    1    2047.2  89185 671.90
## + V4    1      21.1  87117 673.63
## - V7    1    5724.2  92862 675.82
## - V3    1   17816.0 104954 687.70
## 
## Step:  AIC=670.97
## V2 ~ V3 + V6 + V7 + V9
## 
##        Df Sum of Sq    RSS    AIC
## - V6    1     690.3  89020 669.73
## - V9    1    1555.8  89886 670.66
## &lt;none&gt;               88330 670.97
## + V5    1    1192.3  87138 671.65
## + V4    1       6.0  88324 672.96
## - V7    1    5242.0  93572 674.56
## - V3    1   18539.1 106869 687.45
## 
## Step:  AIC=669.73
## V2 ~ V3 + V7 + V9
## 
##        Df Sum of Sq    RSS    AIC
## - V9    1    1836.4  90857 669.71
## &lt;none&gt;               89020 669.73
## + V6    1     690.3  88330 670.97
## + V5    1     499.8  88521 671.18
## + V4    1     121.4  88899 671.59
## - V7    1    4985.4  94006 673.01
## - V3    1   17970.4 106991 685.56
## 
## Step:  AIC=669.71
## V2 ~ V3 + V7
## 
##        Df Sum of Sq    RSS    AIC
## &lt;none&gt;               90857 669.71
## + V9    1    1836.4  89020 669.73
## + V6    1     970.9  89886 670.66
## + V5    1     155.3  90701 671.54
## + V4    1      94.9  90762 671.60
## - V7    1    6612.6  97469 674.52
## - V3    1   24196.6 115053 690.61</code></pre>
<pre class="r"><code>summary(SWfit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = V2 ~ V3 + V7, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -55.145  -7.535  -1.129   4.256 170.018 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    1.060      4.231   0.251   0.8027    
## V3             2.477      0.495   5.003 2.62e-06 ***
## V7            24.647      9.423   2.616   0.0104 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 31.09 on 94 degrees of freedom
## Multiple R-squared:  0.431,  Adjusted R-squared:  0.4189 
## F-statistic:  35.6 on 2 and 94 DF,  p-value: 3.098e-12</code></pre>
<pre class="r"><code>par(mfrow=c(2,2)) # init 4 charts in 1 panel
plot(SWfit)</code></pre>
<p><img src="project1_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<pre class="r"><code>hccm(fit)</code></pre>
<pre><code>##              (Intercept)           V3            V4            V5
## (Intercept) 898.50827280 -1.516688496  0.0914511555 -7.7925239586
## V3           -1.51668850  0.941812897  0.0028810524 -0.0011647811
## V4            0.09145116  0.002881052  0.0007672276 -0.0004454377
## V5           -7.79252396 -0.001164781 -0.0004454377  0.2189205166
## V6           -0.88748476  0.003083616 -0.0159918476 -0.1095185263
## V7          -30.39989696 -1.366584141 -0.1452136615 -0.7557669480
## V9          -60.22027892 -0.400266392 -0.0099063679 -0.8561217604
##                       V6          V7            V9
## (Intercept) -0.887484757 -30.3998970 -60.220278920
## V3           0.003083616  -1.3665841  -0.400266392
## V4          -0.015991848  -0.1452137  -0.009906368
## V5          -0.109518526  -0.7557669  -0.856121760
## V6           0.875629978   6.7973017   0.898364740
## V7           6.797301740 136.7877215  10.170102620
## V9           0.898364740  10.1701026  17.144303775</code></pre>
</div>

<center>Copyright &copy; 2017 Ming Chen  & Wenqiang Feng. All rights reserved.</center>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
